<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Change history for Celery 2.1 — Celery 3.1.23 documentation</title>
<link href="../_static/celery.css" rel="stylesheet" type="text/css"/>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.1.23',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
<script src="../_static/jquery.js" type="text/javascript"></script>
<script src="../_static/underscore.js" type="text/javascript"></script>
<script src="../_static/doctools.js" type="text/javascript"></script>
<link href="../copyright.html" rel="copyright" title="Copyright"/>
<link href="../index.html" rel="top" title="Celery 3.1.23 documentation"/>
<link href="index.html" rel="up" title="History"/>
<link href="changelog-2.0.html" rel="next" title="Change history for Celery 2.0"/>
<link href="changelog-2.2.html" rel="prev" title="Change history for Celery 2.2"/>
</head>
<body role="document">

<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" role="main">
<div class="deck">
<p>
        This document describes the current stable version of Celery (3.1). For development docs,
        <a href="http://docs.celeryproject.org/en/master/history/changelog-2.1.html">go here</a>.
        </p>
</div>
<div class="section" id="change-history-for-celery-2-1">
<span id="changelog-2-1"></span><h1>Change history for Celery 2.1<a class="headerlink" href="#change-history-for-celery-2-1" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#version-2-1-4" id="id11">2.1.4</a><ul>
<li><a class="reference internal" href="#fixes" id="id12">Fixes</a></li>
<li><a class="reference internal" href="#documentation" id="id13">Documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-1-3" id="id14">2.1.3</a></li>
<li><a class="reference internal" href="#version-2-1-2" id="id15">2.1.2</a><ul>
<li><a class="reference internal" href="#v212-fixes" id="id16">Fixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-1-1" id="id17">2.1.1</a><ul>
<li><a class="reference internal" href="#v211-fixes" id="id18">Fixes</a></li>
<li><a class="reference internal" href="#news" id="id19">News</a></li>
</ul>
</li>
<li><a class="reference internal" href="#version-2-1-0" id="id20">2.1.0</a><ul>
<li><a class="reference internal" href="#important-notes" id="id21">Important Notes</a></li>
<li><a class="reference internal" href="#v210-news" id="id22">News</a></li>
<li><a class="reference internal" href="#v210-fixes" id="id23">Fixes</a></li>
<li><a class="reference internal" href="#experimental" id="id24">Experimental</a></li>
<li><a class="reference internal" href="#v210-documentation" id="id25">Documentation</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="version-2-1-4">
<span id="id1"></span><h2><a class="toc-backref" href="#id11">2.1.4</a><a class="headerlink" href="#version-2-1-4" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-12-03 12:00 P.M CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="fixes">
<span id="v214-fixes"></span><h3><a class="toc-backref" href="#id12">Fixes</a><a class="headerlink" href="#fixes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Execution options to <cite>apply_async</cite> now takes precedence over options
returned by active routers.  This was a regression introduced recently
(<a class="reference external" href="https://github.com/celery/celery/issues/244"><span class="xref issue">Issue #244</span></a>).</p>
</li>
<li><p class="first">curses monitor: Long arguments are now truncated so curses
doesn’t crash with out of bounds errors.  (<a class="reference external" href="https://github.com/celery/celery/issues/235"><span class="xref issue">Issue #235</span></a>).</p>
</li>
<li><p class="first">multi: Channel errors occurring while handling control commands no
longer crash the worker but are instead logged with severity error.</p>
</li>
<li><p class="first">SQLAlchemy database backend: Fixed a race condition occurring when
the client wrote the pending state.  Just like the Django database backend,
it does no longer save the pending state (<a class="reference external" href="https://github.com/celery/celery/issues/261"><span class="xref issue">Issue #261</span></a> + <a class="reference external" href="https://github.com/celery/celery/issues/262"><span class="xref issue">Issue #262</span></a>).</p>
</li>
<li><p class="first">Error email body now uses <cite>repr(exception)</cite> instead of <cite>str(exception)</cite>,
as the latter could result in Unicode decode errors (<a class="reference external" href="https://github.com/celery/celery/issues/245"><span class="xref issue">Issue #245</span></a>).</p>
</li>
<li><p class="first">Error email timeout value is now configurable by using the
<a class="reference internal" href="../configuration.html#std:setting-EMAIL_TIMEOUT"><code class="xref std std-setting docutils literal"><span class="pre">EMAIL_TIMEOUT</span></code></a> setting.</p>
</li>
<li><p class="first"><cite>celeryev</cite>: Now works on Windows (but the curses monitor won’t work without
having curses).</p>
</li>
<li><p class="first">Unit test output no longer emits non-standard characters.</p>
</li>
<li><p class="first">worker: The broadcast consumer is now closed if the connection is reset.</p>
</li>
<li><p class="first">worker: Now properly handles errors occurring while trying to acknowledge
the message.</p>
</li>
<li><dl class="first docutils">
<dt><cite>TaskRequest.on_failure</cite> now encodes traceback using the current filesystem</dt>
<dd><p class="first last">encoding.  (<a class="reference external" href="https://github.com/celery/celery/issues/286"><span class="xref issue">Issue #286</span></a>).</p>
</dd>
</dl>
</li>
<li><p class="first"><cite>EagerResult</cite> can now be pickled (<a class="reference external" href="https://github.com/celery/celery/issues/288"><span class="xref issue">Issue #288</span></a>).</p>
</li>
</ul>
</div>
<div class="section" id="documentation">
<span id="v214-documentation"></span><h3><a class="toc-backref" href="#id13">Documentation</a><a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Adding <a class="reference internal" href="../contributing.html#contributing"><span>Contributing</span></a>.</li>
<li>Added <a class="reference internal" href="../userguide/optimizing.html#guide-optimizing"><span>Optimizing</span></a>.</li>
<li>Added <a class="reference internal" href="../faq.html#faq-security"><span>Security</span></a> section to the FAQ.</li>
</ul>
</div>
</div>
<div class="section" id="version-2-1-3">
<span id="id2"></span><h2><a class="toc-backref" href="#id14">2.1.3</a><a class="headerlink" href="#version-2-1-3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-11-09 05:00 P.M CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul id="v213-fixes">
<li><p class="first">Fixed deadlocks in <cite>timer2</cite> which could lead to <cite>djcelerymon</cite>/<cite>celeryev -c</cite>
hanging.</p>
</li>
<li><p class="first"><cite>EventReceiver</cite>: now sends heartbeat request to find workers.</p>
<blockquote>
<div><p>This means <strong class="program">celeryev</strong> and friends finds workers immediately
at startup.</p>
</div></blockquote>
</li>
<li><p class="first">celeryev cursesmon: Set screen_delay to 10ms, so the screen refreshes more
often.</p>
</li>
<li><p class="first">Fixed pickling errors when pickling <code class="xref py py-class docutils literal"><span class="pre">AsyncResult</span></code> on older Python
versions.</p>
</li>
<li><p class="first">worker: prefetch count was decremented by eta tasks even if there
were no active prefetch limits.</p>
</li>
</ul>
</div>
<div class="section" id="version-2-1-2">
<span id="id3"></span><h2><a class="toc-backref" href="#id15">2.1.2</a><a class="headerlink" href="#version-2-1-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-data:</th><td class="field-body">TBA</td>
</tr>
</tbody>
</table>
<div class="section" id="v212-fixes">
<span id="id4"></span><h3><a class="toc-backref" href="#id16">Fixes</a><a class="headerlink" href="#v212-fixes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>worker: Now sends the <a class="reference internal" href="../userguide/monitoring.html#std:event-task-retried"><code class="xref std std-event docutils literal"><span class="pre">task-retried</span></code></a> event for retried tasks.</li>
<li>worker: Now honors ignore result for
<a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.WorkerLostError" title="celery.exceptions.WorkerLostError"><code class="xref py py-exc docutils literal"><span class="pre">WorkerLostError</span></code></a> and timeout errors.</li>
<li>celerybeat: Fixed <a class="reference external" href="http://docs.python.org/dev/library/exceptions.html#UnboundLocalError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal"><span class="pre">UnboundLocalError</span></code></a> in celerybeat logging
when using logging setup signals.</li>
<li>worker: All log messages now includes <cite>exc_info</cite>.</li>
</ul>
</div>
</div>
<div class="section" id="version-2-1-1">
<span id="id5"></span><h2><a class="toc-backref" href="#id17">2.1.1</a><a class="headerlink" href="#version-2-1-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-10-14 02:00 P.M CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="v211-fixes">
<span id="id6"></span><h3><a class="toc-backref" href="#id18">Fixes</a><a class="headerlink" href="#v211-fixes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Now working on Windows again.</p>
<blockquote>
<div><p>Removed dependency on the pwd/grp modules.</p>
</div></blockquote>
</li>
<li><p class="first">snapshots: Fixed race condition leading to loss of events.</p>
</li>
<li><p class="first">worker: Reject tasks with an eta that cannot be converted to a time stamp.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/209"><span class="xref issue">issue #209</span></a></p>
</div></blockquote>
</li>
<li><p class="first">concurrency.processes.pool: The semaphore was released twice for each task
(both at ACK and result ready).</p>
<blockquote>
<div><p>This has been fixed, and it is now released only once per task.</p>
</div></blockquote>
</li>
<li><p class="first">docs/configuration: Fixed typo <cite>CELERYD_TASK_SOFT_TIME_LIMIT</cite> -&gt;
<a class="reference internal" href="../configuration.html#std:setting-CELERYD_TASK_SOFT_TIME_LIMIT"><code class="xref std std-setting docutils literal"><span class="pre">CELERYD_TASK_SOFT_TIME_LIMIT</span></code></a>.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/214"><span class="xref issue">issue #214</span></a></p>
</div></blockquote>
</li>
<li><p class="first">control command <cite>dump_scheduled</cite>: was using old .info attribute</p>
</li>
<li><dl class="first docutils">
<dt>multi: Fixed <cite>set changed size during iteration</cite> bug</dt>
<dd><p class="first last">occurring in the restart command.</p>
</dd>
</dl>
</li>
<li><p class="first">worker: Accidentally tried to use additional command-line arguments.</p>
<blockquote>
<div><p>This would lead to an error like:</p>
<blockquote>
<div><p><cite>got multiple values for keyword argument ‘concurrency’</cite>.</p>
<p>Additional command-line arguments are now ignored, and does not
produce this error.  However – we do reserve the right to use
positional arguments in the future, so please do not depend on this
behavior.</p>
</div></blockquote>
</div></blockquote>
</li>
<li><p class="first">celerybeat: Now respects routers and task execution options again.</p>
</li>
<li><p class="first">celerybeat: Now reuses the publisher instead of the connection.</p>
</li>
<li><p class="first">Cache result backend: Using <a class="reference external" href="http://docs.python.org/dev/library/functions.html#float" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">float</span></code></a> as the expires argument
to <cite>cache.set</cite> is deprecated by the memcached libraries,
so we now automatically cast to <a class="reference external" href="http://docs.python.org/dev/library/functions.html#int" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">int</span></code></a>.</p>
</li>
<li><p class="first">unit tests: No longer emits logging and warnings in test output.</p>
</li>
</ul>
</div>
<div class="section" id="news">
<span id="v211-news"></span><h3><a class="toc-backref" href="#id19">News</a><a class="headerlink" href="#news" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Now depends on carrot version 0.10.7.</p>
</li>
<li><p class="first">Added <a class="reference internal" href="../configuration.html#std:setting-CELERY_REDIRECT_STDOUTS"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_REDIRECT_STDOUTS</span></code></a>, and
<code class="xref std std-setting docutils literal"><span class="pre">CELERYD_REDIRECT_STDOUTS_LEVEL</span></code> settings.</p>
<blockquote>
<div><p><a class="reference internal" href="../configuration.html#std:setting-CELERY_REDIRECT_STDOUTS"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_REDIRECT_STDOUTS</span></code></a> is used by the worker and
beat.  All output to <cite>stdout</cite> and <cite>stderr</cite> will be
redirected to the current logger if enabled.</p>
<p><a class="reference internal" href="../configuration.html#std:setting-CELERY_REDIRECT_STDOUTS_LEVEL"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_REDIRECT_STDOUTS_LEVEL</span></code></a> decides the log level used and is
<code class="xref py py-const docutils literal"><span class="pre">WARNING</span></code> by default.</p>
</div></blockquote>
</li>
<li><p class="first">Added <a class="reference internal" href="../configuration.html#std:setting-CELERYBEAT_SCHEDULER"><code class="xref std std-setting docutils literal"><span class="pre">CELERYBEAT_SCHEDULER</span></code></a> setting.</p>
<blockquote>
<div><p>This setting is used to define the default for the -S option to
<strong class="program">celerybeat</strong>.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">CELERYBEAT_SCHEDULER</span> <span class="o">=</span> <span class="s2">"djcelery.schedulers.DatabaseScheduler"</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Added Task.expires: Used to set default expiry time for tasks.</p>
</li>
<li><p class="first">New remote control commands: <cite>add_consumer</cite> and <cite>cancel_consumer</cite>.</p>
<blockquote>
<div><dl class="method">
<dt>
<code class="descname">add_consumer(queue, exchange, exchange_type, routing_key,</code></dt>
<dt>
<code class="descname">**options)</code></dt>
<dd><p>Tells the worker to declare and consume from the specified
declaration.</p>
</dd></dl>
<dl class="method">
<dt id="cancel_consumer"><a name="//apple_ref/cpp/Method/cancel_consumer"></a>
<code class="descname">cancel_consumer</code><span class="sig-paren">(</span><em>queue_name</em><span class="sig-paren">)</span><a class="headerlink" href="#cancel_consumer" title="Permalink to this definition">¶</a></dt>
<dd><p>Tells the worker to stop consuming from queue (by queue name).</p>
</dd></dl>
<p>Commands also added to <strong class="program">celeryctl</strong> and
<code class="xref py py-class docutils literal"><span class="pre">inspect</span></code>.</p>
<p>Example using celeryctl to start consuming from queue “queue”, in
exchange “exchange”, of type “direct” using binding key “key”:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryctl inspect add_consumer queue exchange direct key
$ celeryctl inspect cancel_consumer queue
</pre></div>
</div>
<p>See <a class="reference internal" href="../userguide/monitoring.html#monitoring-control"><span>Management Command-line Utilities (inspect/control)</span></a> for more information about the
<strong class="program">celeryctl</strong> program.</p>
<p>Another example using <code class="xref py py-class docutils literal"><span class="pre">inspect</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">celery.task.control</span> <span class="kn">import</span> <span class="n">inspect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inspect</span><span class="o">.</span><span class="n">add_consumer</span><span class="p">(</span><span class="n">queue</span><span class="o">=</span><span class="s2">"queue"</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="s2">"exchange"</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">exchange_type</span><span class="o">=</span><span class="s2">"direct"</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">routing_key</span><span class="o">=</span><span class="s2">"key"</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">durable</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">auto_delete</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">inspect</span><span class="o">.</span><span class="n">cancel_consumer</span><span class="p">(</span><span class="s2">"queue"</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">celerybeat: Now logs the traceback if a message can’t be sent.</p>
</li>
<li><p class="first">celerybeat: Now enables a default socket timeout of 30 seconds.</p>
</li>
<li><p class="first">README/introduction/homepage: Added link to <a class="reference external" href="http://github.com/ask/flask-celery">Flask-Celery</a>.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="version-2-1-0">
<span id="id7"></span><h2><a class="toc-backref" href="#id20">2.1.0</a><a class="headerlink" href="#version-2-1-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-10-08 12:00 P.M CEST</td>
</tr>
<tr class="field-even field"><th class="field-name">release-by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="important-notes">
<span id="v210-important"></span><h3><a class="toc-backref" href="#id21">Important Notes</a><a class="headerlink" href="#important-notes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Celery is now following the versioning semantics defined by <a class="reference external" href="http://semver.org">semver</a>.</p>
<blockquote>
<div><p>This means we are no longer allowed to use odd/even versioning semantics
By our previous versioning scheme this stable release should have
been version 2.2.</p>
</div></blockquote>
</li>
</ul>
<ul>
<li><p class="first">Now depends on Carrot 0.10.7.</p>
</li>
<li><p class="first">No longer depends on SQLAlchemy, this needs to be installed separately
if the database result backend is used.</p>
</li>
<li><p class="first">django-celery now comes with a monitor for the Django Admin interface.
This can also be used if you’re not a Django user.
(Update: Django-Admin monitor has been replaced with Flower, see the
Monitoring guide).</p>
</li>
<li><p class="first">If you get an error after upgrading saying:
<cite>AttributeError: ‘module’ object has no attribute ‘system’</cite>,</p>
<blockquote>
<div><p>Then this is because the <cite>celery.platform</cite> module has been
renamed to <cite>celery.platforms</cite> to not collide with the built-in
<a class="reference external" href="http://docs.python.org/dev/library/platform.html#module-platform" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">platform</span></code></a> module.</p>
<p>You have to remove the old <code class="file docutils literal"><span class="pre">platform.py</span></code> (and maybe
<code class="file docutils literal"><span class="pre">platform.pyc</span></code>) file from your previous Celery installation.</p>
<p>To do this use <strong class="program">python</strong> to find the location
of this module:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ python
&gt;&gt;&gt; import celery.platform
&gt;&gt;&gt; celery.platform
&lt;module <span class="s1">'celery.platform'</span> from <span class="s1">'/opt/devel/celery/celery/platform.pyc'</span>&gt;
</pre></div>
</div>
<p>Here the compiled module is in <code class="file docutils literal"><span class="pre">/opt/devel/celery/celery/</span></code>,
to remove the offending files do:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ rm -f /opt/devel/celery/celery/platform.py*
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="v210-news">
<span id="id8"></span><h3><a class="toc-backref" href="#id22">News</a><a class="headerlink" href="#v210-news" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Added support for expiration of AMQP results (requires RabbitMQ 2.1.0)</p>
<blockquote>
<div><p>The new configuration option <code class="xref std std-setting docutils literal"><span class="pre">CELERY_AMQP_TASK_RESULT_EXPIRES</span></code>
sets the expiry time in seconds (can be int or float):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">CELERY_AMQP_TASK_RESULT_EXPIRES</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">60</span>  <span class="c1"># 30 minutes.</span>
<span class="n">CELERY_AMQP_TASK_RESULT_EXPIRES</span> <span class="o">=</span> <span class="mf">0.80</span>     <span class="c1"># 800 ms.</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">celeryev: Event Snapshots</p>
<blockquote>
<div><p>If enabled, the worker sends messages about what the worker is doing.
These messages are called “events”.
The events are used by real-time monitors to show what the
cluster is doing, but they are not very useful for monitoring
over a longer period of time.  Snapshots
lets you take “pictures” of the clusters state at regular intervals.
This can then be stored in a database to generate statistics
with, or even monitoring over longer time periods.</p>
<p>django-celery now comes with a Celery monitor for the Django
Admin interface. To use this you need to run the django-celery
snapshot camera, which stores snapshots to the database at configurable
intervals.</p>
<p>To use the Django admin monitor you need to do the following:</p>
<ol class="arabic">
<li><p class="first">Create the new database tables:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span>$ python manage.py syncdb
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Start the django-celery snapshot camera:</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span>$ python manage.py celerycam
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Open up the django admin to monitor your cluster.</p>
</li>
</ol>
<p>The admin interface shows tasks, worker nodes, and even
lets you perform some actions, like revoking and rate limiting tasks,
and shutting down worker nodes.</p>
<p>There’s also a Debian init.d script for <a class="reference internal" href="../reference/celery.bin.events.html#module-celery.bin.events" title="celery.bin.events"><code class="xref py py-mod docutils literal"><span class="pre">events</span></code></a> available,
see <a class="reference internal" href="../tutorials/daemonizing.html#daemonizing"><span>Running the worker as a daemon</span></a> for more information.</p>
<p>New command-line arguments to celeryev:</p>
<blockquote>
<div><ul class="simple">
<li><code class="xref std std-option docutils literal"><span class="pre">-c|--camera</span></code>: Snapshot camera class to use.</li>
<li><code class="xref std std-option docutils literal"><span class="pre">--logfile|-f</span></code>: Log file</li>
<li><code class="xref std std-option docutils literal"><span class="pre">--loglevel|-l</span></code>: Log level</li>
<li><code class="xref std std-option docutils literal"><span class="pre">--maxrate|-r</span></code>: Shutter rate limit.</li>
<li><code class="xref std std-option docutils literal"><span class="pre">--freq|-F</span></code>: Shutter frequency</li>
</ul>
</div></blockquote>
<p>The <code class="xref std std-option docutils literal"><span class="pre">--camera</span></code> argument is the name of a class used to take
snapshots with. It must support the interface defined by
<a class="reference internal" href="../internals/reference/celery.events.snapshot.html#celery.events.snapshot.Polaroid" title="celery.events.snapshot.Polaroid"><code class="xref py py-class docutils literal"><span class="pre">celery.events.snapshot.Polaroid</span></code></a>.</p>
<p>Shutter frequency controls how often the camera thread wakes up,
while the rate limit controls how often it will actually take
a snapshot.
The rate limit can be an integer (snapshots/s), or a rate limit string
which has the same syntax as the task rate limit strings (<cite>“200/m”</cite>,
<cite>“10/s”</cite>, <cite>“1/h”,</cite> etc).</p>
<p>For the Django camera case, this rate limit can be used to control
how often the snapshots are written to the database, and the frequency
used to control how often the thread wakes up to check if there’s
anything new.</p>
<p>The rate limit is off by default, which means it will take a snapshot
for every <code class="xref std std-option docutils literal"><span class="pre">--frequency</span></code> seconds.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-func docutils literal"><span class="pre">broadcast()</span></code>: Added callback argument, this can be
used to process replies immediately as they arrive.</p>
</li>
<li><p class="first">celeryctl: New command line utility to manage and inspect worker nodes,
apply tasks and inspect the results of tasks.</p>
<blockquote>
<div><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="../userguide/monitoring.html#monitoring-control"><span>Management Command-line Utilities (inspect/control)</span></a> section in the <a class="reference internal" href="../userguide/index.html#guide"><span>User Guide</span></a>.</p>
</div>
<p>Some examples:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryctl apply tasks.add -a <span class="s1">'[2, 2]'</span> --countdown<span class="o">=</span>10

$ celeryctl inspect active
$ celeryctl inspect registered_tasks
$ celeryctl inspect scheduled
$ celeryctl inspect --help
$ celeryctl apply --help
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Added the ability to set an expiry date and time for tasks.</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Task expires after one minute from now.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">task</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">expires</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Also supports datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">task</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="n">expires</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>When a worker receives a task that has been expired it will be
marked as revoked (<a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.TaskRevokedError" title="celery.exceptions.TaskRevokedError"><code class="xref py py-exc docutils literal"><span class="pre">TaskRevokedError</span></code></a>).</p>
</div></blockquote>
</li>
<li><p class="first">Changed the way logging is configured.</p>
<blockquote>
<div><p>We now configure the root logger instead of only configuring
our custom logger. In addition we don’t hijack
the multiprocessing logger anymore, but instead use a custom logger name
for different applications:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%"></col>
<col width="50%"></col>
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Application</strong></th>
<th class="head"><strong>Logger Name</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><cite>celeryd</cite></td>
<td>“celery”</td>
</tr>
<tr class="row-odd"><td><cite>celerybeat</cite></td>
<td>“celery.beat”</td>
</tr>
<tr class="row-even"><td><cite>celeryev</cite></td>
<td>“celery.ev”</td>
</tr>
</tbody>
</table>
<p>This means that the <cite>loglevel</cite> and <cite>logfile</cite> arguments will
affect all registered loggers (even those from 3rd party libraries).
Unless you configure the loggers manually as shown below, that is.</p>
<p><em>Users can choose to configure logging by subscribing to the
:signal:`~celery.signals.setup_logging` signal:</em></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">logging.config</span> <span class="kn">import</span> <span class="n">fileConfig</span>
<span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">signals</span>

<span class="nd">@signals.setup_logging.connect</span>
<span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">fileConfig</span><span class="p">(</span><span class="s2">"logging.conf"</span><span class="p">)</span>
</pre></div>
</div>
<p>If there are no receivers for this signal, the logging subsystem
will be configured using the <code class="xref std std-option docutils literal"><span class="pre">--loglevel</span></code>/<a class="reference internal" href="../reference/celery.bin.base.html#cmdoption--logfile"><code class="xref std std-option docutils literal"><span class="pre">--logfile</span></code></a>
argument, this will be used for <em>all defined loggers</em>.</p>
<p>Remember that the worker also redirects stdout and stderr
to the celery logger, if manually configure logging
you also need to redirect the stdouts manually:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span> <span class="kn">from</span> <span class="nn">logging.config</span> <span class="kn">import</span> <span class="n">fileConfig</span>
 <span class="kn">from</span> <span class="nn">celery</span> <span class="kn">import</span> <span class="n">log</span>

<span class="k">def</span> <span class="nf">setup_logging</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
     <span class="kn">import</span> <span class="nn">logging</span>
     <span class="n">fileConfig</span><span class="p">(</span><span class="s2">"logging.conf"</span><span class="p">)</span>
     <span class="n">stdouts</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">"mystdoutslogger"</span><span class="p">)</span>
     <span class="n">log</span><span class="o">.</span><span class="n">redirect_stdouts_to_logger</span><span class="p">(</span><span class="n">stdouts</span><span class="p">,</span> <span class="n">loglevel</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">worker Added command line option <code class="xref std std-option docutils literal"><span class="pre">-I</span></code>/<code class="xref std std-option docutils literal"><span class="pre">--include</span></code>:</p>
<blockquote>
<div><p>A comma separated list of (task) modules to be imported.</p>
<p>Example:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryd -I app1.tasks,app2.tasks
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">worker: now emits a warning if running as the root user (euid is 0).</p>
</li>
<li><p class="first"><code class="xref py py-func docutils literal"><span class="pre">celery.messaging.establish_connection()</span></code>: Ability to override defaults
used using keyword argument “defaults”.</p>
</li>
<li><p class="first">worker: Now uses <cite>multiprocessing.freeze_support()</cite> so that it should work
with <strong>py2exe</strong>, <strong>PyInstaller</strong>, <strong>cx_Freeze</strong>, etc.</p>
</li>
<li><p class="first">worker: Now includes more metadata for the <a class="reference internal" href="../userguide/tasks.html#std:state-STARTED"><code class="xref std std-state docutils literal"><span class="pre">STARTED</span></code></a> state: PID and
host name of the worker that started the task.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/181"><span class="xref issue">issue #181</span></a></p>
</div></blockquote>
</li>
<li><p class="first">subtask: Merge additional keyword arguments to <cite>subtask()</cite> into task keyword
arguments.</p>
<blockquote>
<div><p>e.g.:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">subtask</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">{</span><span class="s2">"foo"</span><span class="p">:</span> <span class="s2">"bar"</span><span class="p">},</span> <span class="n">baz</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">args</span>
<span class="go">(1, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">kwargs</span>
<span class="go">{"foo": "bar", "baz": 1}</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://github.com/celery/celery/issues/182"><span class="xref issue">issue #182</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">worker: Now emits a warning if there is already a worker node using the same
name running on the same virtual host.</p>
</li>
<li><p class="first">AMQP result backend: Sending of results are now retried if the connection
is down.</p>
</li>
<li><dl class="first docutils">
<dt>AMQP result backend: <cite>result.get()</cite>: Wait for next state if state is not</dt>
<dd><p class="first last">in <code class="xref py py-data docutils literal"><span class="pre">READY_STATES</span></code>.</p>
</dd>
</dl>
</li>
<li><p class="first">TaskSetResult now supports subscription.</p>
<blockquote>
<div><div class="highlight-python3"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">TaskSet</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span><span class="o">.</span><span class="n">apply_async</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Added <cite>Task.send_error_emails</cite> + <cite>Task.error_whitelist</cite>, so these can
be configured per task instead of just by the global setting.</p>
</li>
<li><p class="first">Added <cite>Task.store_errors_even_if_ignored</cite>, so it can be changed per Task,
not just by the global setting.</p>
</li>
<li><p class="first">The crontab scheduler no longer wakes up every second, but implements
<cite>remaining_estimate</cite> (<em>Optimization</em>).</p>
</li>
<li><dl class="first docutils">
<dt>worker:  Store <a class="reference internal" href="../userguide/tasks.html#std:state-FAILURE"><code class="xref std std-state docutils literal"><span class="pre">FAILURE</span></code></a> result if the</dt>
<dd><p class="first last"><a class="reference internal" href="../reference/celery.exceptions.html#celery.exceptions.WorkerLostError" title="celery.exceptions.WorkerLostError"><code class="xref py py-exc docutils literal"><span class="pre">WorkerLostError</span></code></a> exception occurs (worker process
disappeared).</p>
</dd>
</dl>
</li>
<li><p class="first">worker: Store <a class="reference internal" href="../userguide/tasks.html#std:state-FAILURE"><code class="xref std std-state docutils literal"><span class="pre">FAILURE</span></code></a> result if one of the <cite>*TimeLimitExceeded</cite>
exceptions occurs.</p>
</li>
<li><p class="first">Refactored the periodic task responsible for cleaning up results.</p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt>The backend cleanup task is now only added to the schedule if</dt>
<dd><p class="first last"><a class="reference internal" href="../configuration.html#std:setting-CELERY_TASK_RESULT_EXPIRES"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_TASK_RESULT_EXPIRES</span></code></a> is set.</p>
</dd>
</dl>
</li>
<li><p class="first">If the schedule already contains a periodic task named
“celery.backend_cleanup” it won’t change it, so the behavior of the
backend cleanup task can be easily changed.</p>
</li>
<li><p class="first">The task is now run every day at 4:00 AM, rather than every day since
the first time it was run (using crontab schedule instead of
<cite>run_every</cite>)</p>
</li>
<li><dl class="first docutils">
<dt>Renamed <cite>celery.task.builtins.DeleteExpiredTaskMetaTask</cite></dt>
<dd><p class="first last">-&gt; <code class="xref py py-class docutils literal"><span class="pre">celery.task.builtins.backend_cleanup</span></code></p>
</dd>
</dl>
</li>
<li><p class="first">The task itself has been renamed from “celery.delete_expired_task_meta”
to “celery.backend_cleanup”</p>
</li>
</ul>
<p>See <a class="reference external" href="https://github.com/celery/celery/issues/134"><span class="xref issue">issue #134</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">Implemented <cite>AsyncResult.forget</cite> for sqla/cache/redis/tyrant backends.
(Forget and remove task result).</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/184"><span class="xref issue">issue #184</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="xref py py-meth docutils literal"><span class="pre">TaskSetResult.join</span></code>:
Added ‘propagate=True’ argument.</p>
<p>When set to <code class="xref py py-const docutils literal"><span class="pre">False</span></code> exceptions occurring in subtasks will
not be re-raised.</p>
</li>
<li><p class="first">Added <cite>Task.update_state(task_id, state, meta)</cite>
as a shortcut to <cite>task.backend.store_result(task_id, meta, state)</cite>.</p>
<blockquote>
<div><p>The backend interface is “private” and the terminology outdated,
so better to move this to <code class="xref py py-class docutils literal"><span class="pre">Task</span></code> so it can be
used.</p>
</div></blockquote>
</li>
<li><p class="first">timer2: Set <cite>self.running=False</cite> in
<a class="reference internal" href="../internals/reference/celery.utils.timer2.html#celery.utils.timer2.Timer.stop" title="celery.utils.timer2.Timer.stop"><code class="xref py py-meth docutils literal"><span class="pre">stop()</span></code></a> so it won’t try to join again on
subsequent calls to <cite>stop()</cite>.</p>
</li>
<li><p class="first">Log colors are now disabled by default on Windows.</p>
</li>
<li><p class="first"><cite>celery.platform</cite> renamed to <a class="reference internal" href="../internals/reference/celery.platforms.html#module-celery.platforms" title="celery.platforms"><code class="xref py py-mod docutils literal"><span class="pre">celery.platforms</span></code></a>, so it doesn’t
collide with the built-in <a class="reference external" href="http://docs.python.org/dev/library/platform.html#module-platform" title="(in Python v3.6)"><code class="xref py py-mod docutils literal"><span class="pre">platform</span></code></a> module.</p>
</li>
<li><p class="first">Exceptions occurring in Mediator+Pool callbacks are now caught and logged
instead of taking down the worker.</p>
</li>
<li><p class="first">Redis result backend: Now supports result expiration using the Redis
<cite>EXPIRE</cite> command.</p>
</li>
<li><p class="first">unit tests: Don’t leave threads running at tear down.</p>
</li>
<li><p class="first">worker: Task results shown in logs are now truncated to 46 chars.</p>
</li>
<li><dl class="first docutils">
<dt><cite>Task.__name__</cite> is now an alias to <cite>self.__class__.__name__</cite>.</dt>
<dd><p class="first last">This way tasks introspects more like regular functions.</p>
</dd>
</dl>
</li>
<li><p class="first"><cite>Task.retry</cite>: Now raises <a class="reference external" href="http://docs.python.org/dev/library/exceptions.html#TypeError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal"><span class="pre">TypeError</span></code></a> if kwargs argument is empty.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/164"><span class="xref issue">issue #164</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">timedelta_seconds: Use <cite>timedelta.total_seconds</cite> if running on Python 2.7</p>
</li>
<li><p class="first"><code class="xref py py-class docutils literal"><span class="pre">TokenBucket</span></code>: Generic Token Bucket algorithm</p>
</li>
<li><p class="first"><a class="reference internal" href="../reference/celery.events.state.html#module-celery.events.state" title="celery.events.state"><code class="xref py py-mod docutils literal"><span class="pre">celery.events.state</span></code></a>: Recording of cluster state can now
be paused and resumed, including support for buffering.</p>
<blockquote>
<div><dl class="method">
<dt id="State.freeze"><a name="//apple_ref/cpp/Method/State.freeze"></a>
<code class="descclassname">State.</code><code class="descname">freeze</code><span class="sig-paren">(</span><em>buffer=True</em><span class="sig-paren">)</span><a class="headerlink" href="#State.freeze" title="Permalink to this definition">¶</a></dt>
<dd><p>Pauses recording of the stream.</p>
<p>If <cite>buffer</cite> is true, events received while being frozen will be
buffered, and may be replayed later.</p>
</dd></dl>
<dl class="method">
<dt id="State.thaw"><a name="//apple_ref/cpp/Method/State.thaw"></a>
<code class="descclassname">State.</code><code class="descname">thaw</code><span class="sig-paren">(</span><em>replay=True</em><span class="sig-paren">)</span><a class="headerlink" href="#State.thaw" title="Permalink to this definition">¶</a></dt>
<dd><p>Resumes recording of the stream.</p>
<p>If <cite>replay</cite> is true, then the recorded buffer will be applied.</p>
</dd></dl>
<dl class="method">
<dt id="State.freeze_while"><a name="//apple_ref/cpp/Method/State.freeze_while"></a>
<code class="descclassname">State.</code><code class="descname">freeze_while</code><span class="sig-paren">(</span><em>fun</em><span class="sig-paren">)</span><a class="headerlink" href="#State.freeze_while" title="Permalink to this definition">¶</a></dt>
<dd><p>With a function to apply, freezes the stream before,
and replays the buffer after the function returns.</p>
</dd></dl>
</div></blockquote>
</li>
<li><p class="first"><a class="reference internal" href="../reference/celery.events.html#celery.events.EventReceiver.capture" title="celery.events.EventReceiver.capture"><code class="xref py py-meth docutils literal"><span class="pre">EventReceiver.capture</span></code></a>
Now supports a timeout keyword argument.</p>
</li>
<li><p class="first">worker: The mediator thread is now disabled if
<code class="xref std std-setting docutils literal"><span class="pre">CELERY_RATE_LIMITS</span></code> is enabled, and tasks are directly sent to the
pool without going through the ready queue (<em>Optimization</em>).</p>
</li>
</ul>
</div>
<div class="section" id="v210-fixes">
<span id="id9"></span><h3><a class="toc-backref" href="#id23">Fixes</a><a class="headerlink" href="#v210-fixes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Pool: Process timed out by <cite>TimeoutHandler</cite> must be joined by the Supervisor,
so don’t remove it from the internal process list.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/192"><span class="xref issue">issue #192</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>TaskPublisher.delay_task</cite> now supports exchange argument, so exchange can be
overridden when sending tasks in bulk using the same publisher</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/187"><span class="xref issue">issue #187</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">the worker no longer marks tasks as revoked if <a class="reference internal" href="../configuration.html#std:setting-CELERY_IGNORE_RESULT"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_IGNORE_RESULT</span></code></a>
is enabled.</p>
<blockquote>
<div><p>See <a class="reference external" href="https://github.com/celery/celery/issues/207"><span class="xref issue">issue #207</span></a>.</p>
</div></blockquote>
</li>
<li><p class="first">AMQP Result backend: Fixed bug with <cite>result.get()</cite> if
<a class="reference internal" href="../configuration.html#std:setting-CELERY_TRACK_STARTED"><code class="xref std std-setting docutils literal"><span class="pre">CELERY_TRACK_STARTED</span></code></a> enabled.</p>
<blockquote>
<div><p><cite>result.get()</cite> would stop consuming after receiving the
<a class="reference internal" href="../userguide/tasks.html#std:state-STARTED"><code class="xref std std-state docutils literal"><span class="pre">STARTED</span></code></a> state.</p>
</div></blockquote>
</li>
<li><p class="first">Fixed bug where new processes created by the pool supervisor becomes stuck
while reading from the task Queue.</p>
<blockquote>
<div><p>See <a class="reference external" href="http://bugs.python.org/issue10037">http://bugs.python.org/issue10037</a></p>
</div></blockquote>
</li>
<li><p class="first">Fixed timing issue when declaring the remote control command reply queue</p>
<blockquote>
<div><p>This issue could result in replies being lost, but have now been fixed.</p>
</div></blockquote>
</li>
<li><p class="first">Backward compatible <cite>LoggerAdapter</cite> implementation: Now works for Python 2.4.</p>
<blockquote>
<div><p>Also added support for several new methods:
<cite>fatal</cite>, <cite>makeRecord</cite>, <cite>_log</cite>, <cite>log</cite>, <cite>isEnabledFor</cite>,
<cite>addHandler</cite>, <cite>removeHandler</cite>.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="experimental">
<span id="v210-experimental"></span><h3><a class="toc-backref" href="#id24">Experimental</a><a class="headerlink" href="#experimental" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">multi: Added daemonization support.</p>
<blockquote>
<div><p>multi can now be used to start, stop and restart worker nodes:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryd-multi start jerry elaine george kramer
</pre></div>
</div>
<p>This also creates PID files and log files (<code class="file docutils literal"><span class="pre">celeryd@jerry.pid</span></code>,
..., <code class="file docutils literal"><span class="pre">celeryd@jerry.log</span></code>. To specify a location for these files
use the <cite>–pidfile</cite> and <cite>–logfile</cite> arguments with the <cite>%n</cite>
format:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryd-multi start jerry elaine george kramer <span class="se">\</span>
                --logfile<span class="o">=</span>/var/log/celeryd@%n.log <span class="se">\</span>
                --pidfile<span class="o">=</span>/var/run/celeryd@%n.pid
</pre></div>
</div>
<p>Stopping:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryd-multi stop jerry elaine george kramer
</pre></div>
</div>
<p>Restarting. The nodes will be restarted one by one as the old ones
are shutdown:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryd-multi restart jerry elaine george kramer
</pre></div>
</div>
<p>Killing the nodes (<strong>WARNING</strong>: Will discard currently executing tasks):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ celeryd-multi <span class="nb">kill</span> jerry elaine george kramer
</pre></div>
</div>
<p>See <cite>celeryd-multi help</cite> for help.</p>
</div></blockquote>
</li>
<li><p class="first">multi: <cite>start</cite> command renamed to <cite>show</cite>.</p>
<blockquote>
<div><p><cite>celeryd-multi start</cite> will now actually start and detach worker nodes.
To just generate the commands you have to use <cite>celeryd-multi show</cite>.</p>
</div></blockquote>
</li>
<li><p class="first">worker: Added <cite>–pidfile</cite> argument.</p>
<blockquote>
<div><p>The worker will write its pid when it starts.  The worker will
not be started if this file exists and the pid contained is still alive.</p>
</div></blockquote>
</li>
<li><p class="first">Added generic init.d script using <cite>celeryd-multi</cite></p>
<blockquote>
<div><p><a class="reference external" href="http://github.com/celery/celery/tree/master/extra/generic-init.d/celeryd">http://github.com/celery/celery/tree/master/extra/generic-init.d/celeryd</a></p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="v210-documentation">
<span id="id10"></span><h3><a class="toc-backref" href="#id25">Documentation</a><a class="headerlink" href="#v210-documentation" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Added User guide section: Monitoring</p>
</li>
<li><p class="first">Added user guide section: Periodic Tasks</p>
<blockquote>
<div><p>Moved from <cite>getting-started/periodic-tasks</cite> and updated.</p>
</div></blockquote>
</li>
<li><p class="first">tutorials/external moved to new section: “community”.</p>
</li>
<li><p class="first">References has been added to all sections in the documentation.</p>
<blockquote>
<div><p>This makes it easier to link between documents.</p>
</div></blockquote>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="clearer"></div>
</div>

<div class="footer" role="contentinfo">
        © <a href="../copyright.html">Copyright</a> 2009-2015, Ask Solem &amp; Contributors.
    </div>
</body>
</html>